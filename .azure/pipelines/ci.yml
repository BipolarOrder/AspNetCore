# Don't run CI for this config yet. We're not ready to move official builds on to Azure Pipelines
trigger: none

# Run PR validation on all branches
pr:
  branches:
    include:
    - '*'

jobs:
- template: jobs/default-build.yml
  parameters:
    jobName: Windows_Build
    jobDisplayName: "Build and test: Windows"
    agentOs: Windows
    beforeBuild:
    - powershell: "& ./src/Servers/IIS/tools/UpdateIISExpressCertificate.ps1"
      displayName: Setup IISExpress test certificates

- job: Helix
  pool:
    name: Hosted VS2017
    vmImage: vs2017-win2016
  variables:
  - group: Helix Anonymous
  steps:
  - checkout: self
    clean: true
  - script: .\build.cmd -ci /t:Helix /p:Configuration=Debug /p:HelixAccessToken=$(BotAccount-dotnet-github-anon-kaonashi-bot-helix-token)
    displayName: Run build.cmd helix target
